-- 003_additional_metal_data.sql
-- Дополнительные данные для полного наполнения базы

-- Дополнительные ГОСТы (если не хватает)
INSERT INTO gost (code, name, description) VALUES
('ГОСТ 1535-2016', 'Прутки медные', 'Медные прутки различных марок'),
('ГОСТ 13663-86', 'Прокат сортовой стальной горячекатаный', 'Дополнительные сортовые профили'),
('ГОСТ 19265-73', 'Стали быстрорежущие. Марки', 'Р6М5, Р18, быстрорежущие стали'),
('ГОСТ 14959-79', 'Проволока стальная углеродистая пружинная', 'Пружинная проволока'),
('ГОСТ 2246-70', 'Проволока стальная сварочная', 'Сварочная проволока')
ON CONFLICT (code) DO UPDATE SET name = EXCLUDED.name, description = EXCLUDED.description;

-- Дополнительные марки стали (если не хватает)
INSERT INTO steel_grade (name) VALUES
-- Дополнительные углеродистые
('Ст0сп'),('Ст0пс'),('Ст0кп'),('Ст1сп'),('Ст1пс'),('Ст1кп'),
('Ст2сп'),('Ст2пс'),('Ст2кп'),('Ст4сп'),('Ст4пс'),('Ст4кп'),
('Ст5сп'),('Ст5пс'),('Ст5кп'),('Ст6сп'),('Ст6пс'),('Ст6кп'),
-- Дополнительные качественные
('05'),('06'),('07'),('08кп'),('10кп'),('15кп'),('20кп'),('25кп'),('30кп'),('35кп'),('40кп'),('45кп'),('50кп'),
-- Дополнительные легированные
('15Х'),('25Х'),('35Х'),('45Х'),('55Х'),('60Х'),('65Х'),('70Х'),('80Х'),('85Х'),
('15ХМ'),('25ХМ'),('35ХМ'),('45ХМ'),('55ХМ'),('60ХМ'),('65ХМ'),('70ХМ'),('80ХМ'),('85ХМ'),
('15ХМФ'),('25ХМФ'),('35ХМФ'),('45ХМФ'),('55ХМФ'),('60ХМФ'),('65ХМФ'),('70ХМФ'),('80ХМФ'),('85ХМФ'),
-- Дополнительные нержавеющие
('08Х13'),('12Х13'),('20Х13'),('30Х13'),('40Х13'),('08Х17'),('12Х17'),('20Х17'),('30Х17'),('40Х17'),
('08Х18Н10'),('12Х18Н10'),('20Х18Н10'),('30Х18Н10'),('40Х18Н10'),('08Х18Н12'),('12Х18Н12'),('20Х18Н12'),
-- Дополнительные инструментальные
('У7А'),('У8А'),('У9А'),('У10А'),('У11А'),('У12А'),('У13А'),
('9ХС'),('Х12'),('Х12М'),('Х12Ф1'),('Х6ВФ'),('ХВГ'),('9ХВГ'),('ХВ5'),('ХВГС'),('ХВСГФ'),('ХВСГФШ'),
-- Дополнительные быстрорежущие
('Р6М5'),('Р18'),('Р12'),('Р9'),('Р6М5К5'),('Р6М5Ф3'),('Р18Ф2'),('Р12Ф3'),('Р9Ф5'),('Р6М5К8'),('Р6М5Ф2К8'),
-- Дополнительные чугуны
('СЧ10'),('СЧ15'),('СЧ20'),('СЧ25'),('СЧ30'),('СЧ35'),('СЧ40'),('СЧ45'),('СЧ50'),('СЧ55'),('СЧ60'),
('КЧ30'),('КЧ35'),('КЧ40'),('КЧ45'),('КЧ50'),('КЧ55'),('КЧ60'),('КЧ65'),('КЧ70'),('КЧ75'),('КЧ80'),
('ВЧ35'),('ВЧ40'),('ВЧ45'),('ВЧ50'),('ВЧ60'),('ВЧ70'),('ВЧ80'),('ВЧ90'),('ВЧ100'),('ВЧ120'),('ВЧ140'),
-- Дополнительные цветные
('АД31'),('АМг5'),('АМг6'),('АМг3'),('АМг2'),('АМг1'),('АМг0.5'),('АМг0.3'),('АМг0.2'),('АМг0.1'),
('М0'),('М1'),('М2'),('М3'),('М4'),('М5'),('М6'),('М7'),('М8'),('М9'),('М10'),
('Л63'),('Л68'),('Л70'),('Л75'),('Л80'),('Л85'),('Л90'),('Л95'),('Л96'),('Л97'),('Л98'),('Л99'),
('БрАЖ9-4'),('БрАЖ10-4-4'),('БрАЖ11-6-6'),('БрАЖМц10-3-1.5'),('БрАЖН10-4-4'),('БрАЖС7-1-1'),('БрАЖС9-4-4-1'),
('БрОЦС4-4-2,5'),('БрОЦС5-5-5'),('БрОЦС6-6-3'),('БрОЦС7-5-1'),('БрОЦС8-4'),('БрОЦС10-2'),('БрОЦС12'),
('БрОЦСН3-7-5-1'),('БрОЦСН4-4-4'),('БрОЦСН5-5-5'),('БрОЦСН6-6-3'),('БрОЦСН7-5-1'),('БрОЦСН8-4'),('БрОЦСН10-2')
ON CONFLICT (name) DO NOTHING;

-- Дополнительные связи ГОСТ ↔ Марки
-- Дополнительные углеродистые
INSERT INTO gost_grade (gost_id, grade_id)
SELECT g.id, s.id FROM gost g JOIN steel_grade s ON s.name IN ('Ст0сп','Ст0пс','Ст0кп','Ст1сп','Ст1пс','Ст1кп','Ст2сп','Ст2пс','Ст2кп','Ст4сп','Ст4пс','Ст4кп','Ст5сп','Ст5пс','Ст5кп','Ст6сп','Ст6пс','Ст6кп') WHERE g.code = 'ГОСТ 380-2005'
ON CONFLICT DO NOTHING;

-- Дополнительные качественные
INSERT INTO gost_grade (gost_id, grade_id)
SELECT g.id, s.id FROM gost g JOIN steel_grade s ON s.name IN ('05','06','07','08кп','10кп','15кп','20кп','25кп','30кп','35кп','40кп','45кп','50кп') WHERE g.code = 'ГОСТ 1050-2013'
ON CONFLICT DO NOTHING;

-- Дополнительные легированные
INSERT INTO gost_grade (gost_id, grade_id)
SELECT g.id, s.id FROM gost g JOIN steel_grade s ON s.name IN ('15Х','25Х','35Х','45Х','55Х','60Х','65Х','70Х','80Х','85Х','15ХМ','25ХМ','35ХМ','45ХМ','55ХМ','60ХМ','65ХМ','70ХМ','80ХМ','85ХМ') WHERE g.code = 'ГОСТ 4543-2016'
ON CONFLICT DO NOTHING;

-- Дополнительные нержавеющие
INSERT INTO gost_grade (gost_id, grade_id)
SELECT g.id, s.id FROM gost g JOIN steel_grade s ON s.name IN ('08Х13','12Х13','20Х13','30Х13','40Х13','08Х17','12Х17','20Х17','30Х17','40Х17','08Х18Н10','12Х18Н10','20Х18Н10','30Х18Н10','40Х18Н10','08Х18Н12','12Х18Н12','20Х18Н12') WHERE g.code = 'ГОСТ 5632-2014'
ON CONFLICT DO NOTHING;

-- Дополнительные инструментальные
INSERT INTO gost_grade (gost_id, grade_id)
SELECT g.id, s.id FROM gost g JOIN steel_grade s ON s.name IN ('У7А','У8А','У9А','У10А','У11А','У12А','У13А') WHERE g.code = 'ГОСТ 1435-99'
ON CONFLICT DO NOTHING;

INSERT INTO gost_grade (gost_id, grade_id)
SELECT g.id, s.id FROM gost g JOIN steel_grade s ON s.name IN ('9ХС','Х12','Х12М','Х12Ф1','Х6ВФ','ХВГ','9ХВГ','ХВ5','ХВГС','ХВСГФ','ХВСГФШ') WHERE g.code = 'ГОСТ 5950-2000'
ON CONFLICT DO NOTHING;

-- Дополнительные быстрорежущие
INSERT INTO gost_grade (gost_id, grade_id)
SELECT g.id, s.id FROM gost g JOIN steel_grade s ON s.name IN ('Р6М5','Р18','Р12','Р9','Р6М5К5','Р6М5Ф3','Р18Ф2','Р12Ф3','Р9Ф5','Р6М5К8','Р6М5Ф2К8') WHERE g.code = 'ГОСТ 19265-73'
ON CONFLICT DO NOTHING;

-- Дополнительные чугуны
INSERT INTO gost_grade (gost_id, grade_id)
SELECT g.id, s.id FROM gost g JOIN steel_grade s ON s.name IN ('СЧ10','СЧ15','СЧ20','СЧ25','СЧ30','СЧ35','СЧ40','СЧ45','СЧ50','СЧ55','СЧ60') WHERE g.code = 'ГОСТ 1412-85'
ON CONFLICT DO NOTHING;

INSERT INTO gost_grade (gost_id, grade_id)
SELECT g.id, s.id FROM gost g JOIN steel_grade s ON s.name IN ('КЧ30','КЧ35','КЧ40','КЧ45','КЧ50','КЧ55','КЧ60','КЧ65','КЧ70','КЧ75','КЧ80') WHERE g.code = 'ГОСТ 1414-75'
ON CONFLICT DO NOTHING;

INSERT INTO gost_grade (gost_id, grade_id)
SELECT g.id, s.id FROM gost g JOIN steel_grade s ON s.name IN ('ВЧ35','ВЧ40','ВЧ45','ВЧ50','ВЧ60','ВЧ70','ВЧ80','ВЧ90','ВЧ100','ВЧ120','ВЧ140') WHERE g.code = 'ГОСТ 977-88'
ON CONFLICT DO NOTHING;

-- Дополнительные цветные
INSERT INTO gost_grade (gost_id, grade_id)
SELECT g.id, s.id FROM gost g JOIN steel_grade s ON s.name IN ('АД31','АМг5','АМг6','АМг3','АМг2','АМг1','АМг0.5','АМг0.3','АМг0.2','АМг0.1') WHERE g.code = 'ГОСТ 4784-2019'
ON CONFLICT DO NOTHING;

INSERT INTO gost_grade (gost_id, grade_id)
SELECT g.id, s.id FROM gost g JOIN steel_grade s ON s.name IN ('М0','М1','М2','М3','М4','М5','М6','М7','М8','М9','М10') WHERE g.code = 'ГОСТ 859-2014'
ON CONFLICT DO NOTHING;

INSERT INTO gost_grade (gost_id, grade_id)
SELECT g.id, s.id FROM gost g JOIN steel_grade s ON s.name IN ('Л63','Л68','Л70','Л75','Л80','Л85','Л90','Л95','Л96','Л97','Л98','Л99') WHERE g.code = 'ГОСТ 15527-2004'
ON CONFLICT DO NOTHING;

INSERT INTO gost_grade (gost_id, grade_id)
SELECT g.id, s.id FROM gost g JOIN steel_grade s ON s.name IN ('БрАЖ9-4','БрАЖ10-4-4','БрАЖ11-6-6','БрАЖМц10-3-1.5','БрАЖН10-4-4','БрАЖС7-1-1','БрАЖС9-4-4-1') WHERE g.code = 'ГОСТ 18175-78'
ON CONFLICT DO NOTHING;

INSERT INTO gost_grade (gost_id, grade_id)
SELECT g.id, s.id FROM gost g JOIN steel_grade s ON s.name IN ('БрОЦС4-4-2,5','БрОЦС5-5-5','БрОЦС6-6-3','БрОЦС7-5-1','БрОЦС8-4','БрОЦС10-2','БрОЦС12','БрОЦСН3-7-5-1','БрОЦСН4-4-4','БрОЦСН5-5-5','БрОЦСН6-6-3','БрОЦСН7-5-1','БрОЦСН8-4','БрОЦСН10-2') WHERE g.code = 'ГОСТ 5017-2006'
ON CONFLICT DO NOTHING;

-- Дополнительные примеры металлопроката
WITH sys_wh AS (
    SELECT id FROM warehouse WHERE city = 'Екатеринбург' AND supplier = 'SYSTEM' LIMIT 1
)
INSERT INTO metal (name, state_standard, category, stamp, diameter, thickness, width, length, material, price, unit, price_updated_at, comments, warehouse_id)
SELECT * FROM (
    VALUES
    -- Дополнительный листовой прокат
    ('Лист горячекатаный', 'ГОСТ 19903-2015', 'листовой', 'Ст3сп', NULL, 2.0, 1000.0, 2000.0, 'Сталь', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh)),
    ('Лист горячекатаный', 'ГОСТ 19903-2015', 'листовой', 'Ст3сп', NULL, 4.0, 1250.0, 2500.0, 'Сталь', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh)),
    ('Лист горячекатаный', 'ГОСТ 19903-2015', 'листовой', '09Г2С', NULL, 6.0, 1500.0, 6000.0, 'Сталь', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh)),
    ('Лист холоднокатаный', 'ГОСТ 19904-2015', 'листовой', '08', NULL, 0.5, 1000.0, 2000.0, 'Сталь', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh)),
    ('Лист холоднокатаный', 'ГОСТ 19904-2015', 'листовой', '08', NULL, 1.5, 1000.0, 2000.0, 'Сталь', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh)),
    
    -- Дополнительный сортовой прокат
    ('Круг горячекатаный', 'ГОСТ 2590-2006', 'сортовой', '20', 10.0, NULL, NULL, 6000.0, 'Сталь', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh)),
    ('Круг горячекатаный', 'ГОСТ 2590-2006', 'сортовой', '20', 30.0, NULL, NULL, 6000.0, 'Сталь', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh)),
    ('Круг горячекатаный', 'ГОСТ 2590-2006', 'сортовой', '45', 40.0, NULL, NULL, 6000.0, 'Сталь', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh)),
    ('Квадрат горячекатаный', 'ГОСТ 2591-2006', 'сортовой', 'Ст3сп', 10.0, NULL, NULL, 6000.0, 'Сталь', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh)),
    ('Квадрат горячекатаный', 'ГОСТ 2591-2006', 'сортовой', 'Ст3сп', 30.0, NULL, NULL, 6000.0, 'Сталь', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh)),
    ('Шестигранник', 'ГОСТ 2879-2006', 'сортовой', '20', 10.0, NULL, NULL, 6000.0, 'Сталь', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh)),
    ('Шестигранник', 'ГОСТ 2879-2006', 'сортовой', '20', 20.0, NULL, NULL, 6000.0, 'Сталь', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh)),
    
    -- Дополнительный фасонный прокат
    ('Уголок равнополочный', 'ГОСТ 8509-93', 'фасонный', 'Ст3сп', NULL, 3.0, 40.0, 6000.0, 'Сталь', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh)),
    ('Уголок равнополочный', 'ГОСТ 8509-93', 'фасонный', 'Ст3сп', NULL, 5.0, 60.0, 6000.0, 'Сталь', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh)),
    ('Швеллер', 'ГОСТ 8240-97', 'фасонный', '09Г2С', NULL, 4.0, 80.0, 6000.0, 'Сталь', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh)),
    ('Швеллер', 'ГОСТ 8240-97', 'фасонный', '09Г2С', NULL, 8.0, 120.0, 6000.0, 'Сталь', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh)),
    ('Двутавр', 'ГОСТ 8239-89', 'фасонный', 'Ст3сп', NULL, 6.0, 150.0, 6000.0, 'Сталь', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh)),
    ('Двутавр', 'ГОСТ 8239-89', 'фасонный', 'Ст3сп', NULL, 10.0, 250.0, 6000.0, 'Сталь', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh)),
    
    -- Дополнительные трубы
    ('Труба электросварная', 'ГОСТ 10704-91', 'трубный', 'Ст3сп', 32.0, 2.5, NULL, 6000.0, 'Сталь', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh)),
    ('Труба электросварная', 'ГОСТ 10704-91', 'трубный', 'Ст3сп', 76.0, 4.0, NULL, 6000.0, 'Сталь', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh)),
    ('Труба бесшовная', 'ГОСТ 8732-78', 'трубный', '20', 32.0, 3.0, NULL, 6000.0, 'Сталь', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh)),
    ('Труба бесшовная', 'ГОСТ 8732-78', 'трубный', '20', 89.0, 5.0, NULL, 6000.0, 'Сталь', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh)),
    ('Труба квадратная', 'ГОСТ 8639-82', 'трубный', 'Ст3сп', 20.0, 1.5, 20.0, 6000.0, 'Сталь', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh)),
    ('Труба квадратная', 'ГОСТ 8639-82', 'трубный', 'Ст3сп', 60.0, 3.0, 60.0, 6000.0, 'Сталь', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh)),
    
    -- Дополнительная арматура
    ('Арматура периодическая', 'ГОСТ 5781-82', 'арматура', 'A500C', 8.0, NULL, NULL, 12000.0, 'Сталь', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh)),
    ('Арматура периодическая', 'ГОСТ 5781-82', 'арматура', 'A500C', 10.0, NULL, NULL, 12000.0, 'Сталь', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh)),
    ('Арматура периодическая', 'ГОСТ 5781-82', 'арматура', 'A400', 14.0, NULL, NULL, 12000.0, 'Сталь', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh)),
    ('Арматура периодическая', 'ГОСТ 5781-82', 'арматура', 'A400', 18.0, NULL, NULL, 12000.0, 'Сталь', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh)),
    ('Арматура периодическая', 'ГОСТ 5781-82', 'арматура', 'A400', 20.0, NULL, NULL, 12000.0, 'Сталь', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh)),
    
    -- Дополнительные цветные металлы
    ('Лист алюминиевый', 'ГОСТ 4784-2019', 'листовой', 'АД31', NULL, 1.0, 1000.0, 2000.0, 'Алюминий', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh)),
    ('Лист алюминиевый', 'ГОСТ 4784-2019', 'листовой', 'АД31', NULL, 3.0, 1000.0, 2000.0, 'Алюминий', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh)),
    ('Пруток медный', 'ГОСТ 1535-2016', 'сортовой', 'М1', 10.0, NULL, NULL, 6000.0, 'Медь', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh)),
    ('Пруток медный', 'ГОСТ 1535-2016', 'сортовой', 'М1', 30.0, NULL, NULL, 6000.0, 'Медь', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh)),
    ('Лист латунный', 'ГОСТ 15527-2004', 'листовой', 'Л63', NULL, 0.5, 1000.0, 2000.0, 'Латунь', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh)),
    ('Лист латунный', 'ГОСТ 15527-2004', 'листовой', 'Л63', NULL, 2.0, 1000.0, 2000.0, 'Латунь', NULL, 'т', NOW(), 'Справочник', (SELECT id FROM sys_wh))
) AS v(name, state_standard, category, stamp, diameter, thickness, width, length, material, price, unit, price_updated_at, comments, warehouse_id)
WHERE NOT EXISTS (
    SELECT 1 FROM metal m
    WHERE m.name = v.name AND COALESCE(m.state_standard,'') = COALESCE(v.state_standard,'')
      AND COALESCE(m.category,'') = COALESCE(v.category,'') AND COALESCE(m.stamp,'') = COALESCE(v.stamp,'')
);
